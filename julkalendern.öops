<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "https://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html lang="tlh" xmlns="https://www.w3.org/1999/xhtml">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>13 DAYS OF LAGGAN HOLIDAYS</title>
	<link rel="stylesheet" href="https://unpkg.com/sanitize.css" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/comic-mono@0.0.1/index.css" />
	<link rel="stylesheet" href="secrets.css" />
	<link rel="icon" href="favicon.ico">
	<style type="text/css">
		#snön {
			display: block;
			position: fixed;
			left: 0;
			top: 0;
			right: 0;
			bottom: 0;
			background-color: #0F2027;
			background-image: linear-gradient(to bottom, #0F2027, #080e10);
		}
	</style>
	<script type="text/javascript">
		störstaDistansen = -100000
	</script>
	<script src="https://greggman.github.io/webgl-lint/webgl-lint.js" crossorigin></script>
	<script type="text/javascript" src="UngeMozartdenjäveln.js"></script>
</head>

<body>
	<div id="wrapper">
		<div id="snön"></div>
		<div id="bg"></div>
	</div>
</body>
<img id="solen" style="position: fixed; left: 100vw; top: 100vh;" src="lagganmas/solen.png">
<script type="text/javascript">
	// baserad på https://github.com/bsehovac/shader-program exemplen

	snöflinga = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGAGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTUtMDctMDNUMTg6NTk6MjIrMDI6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTAxLTEyVDE1OjE0OjQwKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTAxLTEyVDE1OjE0OjQwKzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmIzMzBlMWI0LTk5ZDctNGU2NS05MGQ2LTNmYjFiYmE2ZTE0MCIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjAyNThjNzMxLTQ4ZjQtYTA0MS1hNGFkLTQ4MTA2MTVjY2FlYSIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjJjY2VkMTUyLTRjNzAtNDFlZC1hMzcyLWRlOWY4NjgyZTcwMSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MmNjZWQxNTItNGM3MC00MWVkLWEzNzItZGU5Zjg2ODJlNzAxIiBzdEV2dDp3aGVuPSIyMDE1LTA3LTAzVDE4OjU5OjIyKzAyOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YjMzMGUxYjQtOTlkNy00ZTY1LTkwZDYtM2ZiMWJiYTZlMTQwIiBzdEV2dDp3aGVuPSIyMDE5LTAxLTEyVDE1OjE0OjQwKzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz50mbqsAAAToElEQVR4nOVbW49dR5X+VlXtc2v3Ne52N6bTTnAc0u02GRJQwEhYQkJ5QhmhPPOUl0iBB/4AP4JfMA95IEIaJEYiQhlesCZMEE1iGxJHIjK21XbSwX1xd5+zd9Va87BrVdfefWwI4xEaUVJpn7PPPnVqfbUu31pVh0QE/8zN/KMn8I9uTl+8+uqrAAARgYgghIBer4dnnnkGAPDFL34RANDr9eiJJ55AVVUgIhhjwMwYDAbY3Nyk8+fPP/DHdnd3ZWtrS6y1ICICACLCtWvXxDmH2dlZXL9+HR988AF6vR5mZmawvb2Nw8NDeO+xt7eHpaUlDAYDTE5O4vvf/z7OnTuH1157DR9++CGICNvb2zh58iTubG7iwrP/gvmz61iZG2B5aQG/+e93MDExgW9/+9vHAcgbEWFvbw+Tk5O0uLiIEydOyPnz52lychL9fj89BgD7+/s0MTGh4KT749rU1JRMTU3p22R7y8vL2N3dTWPs7e3JnTt3sLW1BWvtAwF9FK0BQFwUfPLJJ5ibm8Mrr7yiGqCmkgtHZVni4OCAJiYmCAAiEA0AmBlEpGPnDoez1wqMrK2tydraGr333nu4evUqfv/730tZluh2u405PqqWABgOhwCAnZ0dLCws4Ec/+hGdOnUqf5ZEhA4ODtDr9chaS51OB/Pz84QjoRsA6bjOOel0OknY7HMBgL/85S8yGo1kYWEB1loCIBcuXMCFCxdkfX2dNjY25J133sH9+/chIo8UhATA5z//eRweHmJxcRHf+973iIioqioURaGTNQBQlqWJq2GYGWVZUq/XGwcCAVCTkUxg7UDUgtnZWd7e3hZmhrVWkGnH+vo61tfX8eUvfxlvvPGG3Lx5E8vLy8hM6dEA0Ov1MBwO8eKLL+Lpp5/GRx99hLm5ORXGACAiotnZWROFIQDGGJNee+8hIlQURVqibLUku2pnAEJEZnZ2VoXmDKwExPnz57G8vIxf/epXuHXrlnz88ccoyxLe+/+VRiQA7t+/j+npaaytrREAeuKJJ/SjXGACQCEEIyLGOWc6nQ6h1gZTVZWJqv6g8MoAwMwiImyt5UxQ7TlIlIMwPT2Nl156SXZ3d+nKlSuoqkq2t7f/buEbADjncOnSJXrssceAphorABARC8CIiBERKyI2hGCcc0REptPpGGttDhhCCClc5gKKSC50qKqKrbVsjMnvqzbw7u6uMDPNzMzw1NSUXLx4ET/5yU/o5s2b8t5772E0GmFycvIz+4gEwNmzZ/H0008DqD33cDikfr9vNFwDMGVZWmutcc5ZAE5EbDQBS0QqvEF0mAAoCq5NALAxRlqCBmstExEDCLHrZwIgFEUhckRbBQBefvllAYC3334bV65ckY2NDezv738mEBIA3nuMRiOgVmfa39+nbrdL0SsbAKbT6Zi46tZaa4nIEpGN49j4nI2AkYiYLAQmAFQoACwiLCKBiAIRBQA+jqNgMADq9/v63mZjAABeeOEFvPDCC3Tt2jV5/fXX5U9/+hMI+Js4RFoe51yK1c45zM/P58ITAENExtRL6mIvAHS0i0iXmbsAekTUN8b0AfRFpA+gD2AQez+79gD0RETH6cZrkf1GfjUP6FhbW6Mf/OAHeOmll6jb7WBrawvAw7lD0oAzZ86gFfeBzNtrZ2Zna2gLEXFRAwpmLuJnyT+ISMQr+ZTc+wcAuvIetUlV8bVFUxNyZxiy9/l4BAALCwvmu9/9rpxZWaH/evs3Mqw8HpbvJQDW19d1xfPeBsEyswVQeO+dtdZZa9NqWWsLAI6IHOoQaVpjHQMgdi8iPgJQReHzbgFU2ULo9/JQmfMLPPf881j/0pfk3376H9gyI6ycXnw4ALOzs+lmCIEODg7oxIkThohoOBxSp9MxRGSdczZGA0tEBWpNKIwxHX0dx3XRB+QAAE0foDbviaiKwBVRWO3Wex9ql0MBzbAcsnFzcAFAOkVBFy88hW63J1UIGJf6JwCuXLmC9fV1AIAxBv1+H0QEESEiMsxs1NMTke10OiqkE5GO2rAxJtksERkRMaj9R1sLfJysB1CFEEpjjGqA+hiDWrPK+H3ViFxLc2eZTEHbM6trAIB3331XNOEaC8DCwoK+JCKCc47ia1Lq2+oWtboXRFREALpxzA4Ruegj9FnDzDDGCABmZjbGqPqXOFr5Ml5HqE2uin6mxFGk0V4B4LIsiYh8pO05yBxCECLC4uIiXbp0SbJstgnA3t5e7gTbbrNBf9sgKBCoTSBFBUSugMgTAGiMlizmewClMcYDGMXvlxHUMgpeZgInrhEB9Vm48/GawuSNGzdodnYWp06dEu89QsitJgMgQ08R1FhOIQTKihgkIoaZrTEm8QARSUCISBf1ihbRri1iGG0BwKjtvxOFdHoVERdC0N8wkVjlpqTFG2nFe5/P//Tp0+JcLeb169dxeHiI55577jgAjz/+OFqt7TFyDSBmJiIyquIRgEJVH7UZFDiK3xoZdPICgDOvn6/2iIg03ObEikSEtAoVgcznKXF+6V6321VtoNXVVezs7DTkSkRoc3OzDUAtde0PGmSCiKgoCiIiik6uZkiRJEWG6IhInWNXRHpE1ENNfnJSNJFdJwBMiMgEgAkiGhCRPt8D0DPGdBVcZi7UxHDcR7XDOLz3+POf/9yQb5wT1C8pomNbCAHMTDE85TTYoqUJiOaAOpHK9VWjQRE5gM3GyHMKAIAxRqQOS0xE4pxrpMwA2HtvALA68Vwea60sLy+PB+Djjz/G5z73OZ1UTiqkqiohImFmFEUhRCTGmLzUlTcTBVWTKBBXTBki1U1/i1E7N/UVyi5T0RS1xQgza/1gXBrNcXyOmsg4YpLQsbz3qRLVAGB+fr4tCLz3IiKKtMQQJnEwtb8crBQ6lT/ESSQHSURKpAT1CodoLho2rSZRugAikjLFzHmGOG6izhlXaZOvJPTJkyePrRYAIBYWGiqvzEmFNcao0ByLGg1NyX8w8w+5eeRa0RWRDhF1Ee0bNY9QX6G9LyI9EenGZ/NESbsFoKm6EREzGo00cjR8wc7OTgOApAFxdRt1u6IokpqJCHvvWfN2XRGuwwFnK5OnqkkTMmflEHlBZgYBRyGONFTGz5jqBCnPFRwAx8zqcBt+AwBFx50zRgFAw+FQpqenjwNw9+5ddLtdnDhxQifV6MwsRMTGGGHmRkEjqjFHVU3fia9T+IwTUpMw2cRyz60rlhMl1ZqCmQuKeUO09UTTs/HbJqBNBoNB40YygY2NDezt7Y35Tj0Zay0751hEQqSwqefvY4Ejd1LqM6B5QeyaMjsR0SQq74lRRqKkxKqgZhGmHQa1RjkWhHY+kDTga1/7mjrCdtUWcSD23jMRBWttyuSIqBIRVVEPwBtjqgyMoGGrsRS1o1M75YzhtWlyyjjj1ajKM7OlukjTSOOJKGe2DSBipEstacCPf/xjvPnmm405olV0cM6FWMkNAEIIIYhIEJHAzIGIfLRXBScvdXE0k6QRes1UN88xbKYx6jPymoQxxhiKmWrm8Nr1jEbb399vvE8a8Morr2Bubi53hNpUCwxqLQjW2hALGAFHK14BqJi5QqYZCkh8VkFgHK16Hu/y0Jm/TnZtjEkFV2amGgP6mwuhmhdoSxrQ6XRw69YtfPjhh+3vNKo41tpUxnLOqVfOe+L0+WfRcWnxI2lF5i8Sr49JzrjKlIKUkyS9Nljj39oSHLdu3UJZlpiammonFzqohiolJKmaE4X0AKpcG3CU4alj03Q2D1mIgqUQqpEk4yH6TEPAfMVzkhaf1Wca9733yFsC4Jvf/Ga6eePGDSwuLkq3202/EEKQw8ND7vV6wTmXfIBGgBBCZa11RKQakKe4eVZIOMrwEAE1aDo/NRENs6nFvcNxPckOQEII4r3XLfvU2u+PbWHdvXsXP/vZz2R3d7fxAzEfYOeclrG8McZHx1dZa0sAlYhUrUKG9rFmgjHmgiONUocaiEjB5pgWJFDGACHOOXQ6nXYyJwcHB40bSQM0PpZlia9//esgInz66acYDAbS7/el1+vl5WldIR9XXusBlYJgrS2ZeRR5foFY4oo/Rzji+GoOwBG3aFSGc0eqYTUDpr2VxiIiVVVJBKABTntXOQGwsbEBoK4MTUxM4Nq1a7DWyurqKvr9fu4LGltaWtcjokRViaiUowqRFk+1LKarwkQUYgKUp98hRo9cEyoc+Z1kJpnwDUGJSLfZj7XLv/41Ln7jG8cBmJycTDe99xgMBlhZWUG/34fm4DiqtugkTFTHYK2toqClMSavE+bbZg0AolAujoM6fxI1sWQ6GSBKuJR7sDGGiYhDCJwla+N8BUQERcssEgBxXzA1IsL169fhvcezzz6LmZkZnTRQU01NjnRlQlx93cRQB5gXRY8BEEHLa4XJDESkAlBGv6J8Q/1OCHWFs60NHBM0oeaxHGEAZ7/61YacCYCvfOUrjQ9iLAZQcwS9rVctkuS0GEf5uZawx5WqdEWUHCnLUwKWA1ACGBljSmYu0XSMPv42I+4469hVVYlzTjIzEABg7/Hrt97Cd1588TgA4zYNFIiDgwM5efJkftyFu92u7tLoVpWPk05cHc0ymTo6TaN1T1ALIMeywBhSRwoCjkeJPClLGhALoTrXpPLGGLlw7lxDvgRAe8Mgb4PBIP88IT0cDrkoimCt1ZS0kqPydc7rc9Kjds5RrS0zK/UFjtih0ulSREaoQ+UIx0NqDkR7w7ThBzY2NrC7u4szTz752QBotYRop9PRukBgZmOtJWOMCSFUmqigWZBIDjSuvgPgjDGavipzy80qlcrRigo4rgFt4dN8RQR5IeQYABcvXnygxLdv38Zrr72GH/7wh3myxNnWNzvngvfeOOd8FttV7TXuCx1thzf2CzIfoOww3x3OQVBfkK9+mws0vP/W1pZcv35dTp48ibm5ufEA6GnPdhMRTExMYHJyMs4/edbGigKgeERGdz8aiUx0qoIsj4j5fHKCUu9Cae0x8QvUkaCt+rkW5IXSvEwuADA3N4fnn38eRVEc2yEmvfHHP/5xLAAKAhHh3LlzjTMEIQQ3Go3MYDAwAFw8M2BjbE9VHIm7x3HnuMg+y2uFjb2ILBwGHGmAR51yj1DvJ+q9HBzVCjUlvnfvnty4cUO0SLK2tpZkSxqwsrIyVngiSsddx5y5YWOMbjhyzA2AOlevgNrzxqKHZAXUEFmj8oMcAAUhX1HPzJUxplK2GULwqJmor6qKY54iQE3kdnd3OdY35He/+51cvnwZExMTMMY0AEga0CZCbRC89/DeY2pqKs/TDQA6PDw0uolpjLHOOcfMzntvnXPOGFOISBFCKGLG6Jg5rw6bPM9HdogiRgT1GxUze135yBBLLcyo1ohIqKqKO51OKMtS3n//fckLJhcuXDiuAXfu3HkgAABweHiYb5/lbI76/T6JCO/s7ICIMD09jbhzlJe2OdJXZ611xpik+sxsRUTNqyYtzcqzRoQQt9FTPTKEkMryMV1nItJECKPRCH/4wx/SHmcbgKQB77777kMBUAR7vR594QtfQLb3ljRBRCiGQ43tNhNU9wotxd0hZrbWWqrLCibXAM0/NGNMSVCoz+h5730wxngR8cwcnHNp1XHkA0RE+ODgoOH5coefNODnP//5QwGg+GeElZUVefLJJ8fVDYmISP0EM0sIAd1ut6EFEQwTQtBTZCYSKZWfdOs7jpMSHsSSnF5jPpCKJ51Oh9vz8t5ja2urUTMcC4Cex39Y63Q6WFlZQVEUcu/ePep2uxgMBnmWqBrBzjndUzQAJO7aSqwm6Va60mATQtATH3k0yLM6RvQJ6khRO0dmZv2cEfnGaDSSbreLoihQVRVCCGMPTuZbY38VAGstiqLAaDTC66+/Lt/61rf0rzQPqiKnvQU9GxTvKwB65s9E+0x1/QwEHVMTHXbOcfQFbK1VX5GYX1mWuH37NpaXl2l3d5eXl5cfeGp07F9mHtaICGVZYjAYYGZmRgDQaDSSoijywmQuHEUA8tp/ewsrnUkOIehefg5AIl5RzVPPs8DsGTlz5oxYa+XevXu4c+dOntHiXJYQfWYA1Jacc7r7Im+++SZWV1fp7NmzOlktn7XBUHJCIQRDddxUUqUHq5MGVFUFAIibtOrUhJnVNDi7z3fv3hURkaWlpWQ6Tz311EPl+cwAjGvRxnS1xjrI1n0ajUbinCNdGf2vQQyFABqHnZMmhBAkaiADkMPDQ4n/cJPhcIj5+Xl1nvj3n/4UB/v7ODEx0ZjQv7788qMFoNPppBj76aefyi9+8QssLS3JpUuXKNt2b+QGg8EgrzNSr9djzQi1jTlqj+hcARz9+cJ7D+ecnDlzJiVABwcH0GNxh/H/UOPaIwEgb/fv38fVq1fbyVVuy5RdtVGkrzQzM/Mwhyzta/Y7aZE/+ugj/Odbb8n0zAzmTp1CfbJmfHvkADjnMDMzg8ceewzGGNnf38fly5fp9OnTknNwNEEQay2mpqbaf7Bot3alV8a9/u1vfytXr13D6uoqyrJ86Hz/euz7O5uivr29jV/+8peyubmZx/Njh5xiMjMutz/WfVXxzs4O7+zsyL1792R/f78RBRYWFjA5OYm4OXKs5+2Ra0C7OeewsLCA+F+kvKUVGw6H2Nzc1Pxh7DiBGT0iWXr8cbp5+zY+eP99mZ6exsHBAZaWlrC6upqefZjKt1vKBf5Z2/+ZCfx/af8DTo8DJZHbJ6cAAAAASUVORK5CYII='

	behållaren = hämtaRadiatorEfterLegitimation('snön')
	tavlan = skapaElement( tavla )
	mb = tavlan[hämtaSammanhang]( nätmb, { antialias: sant } )

	om(mb, () => {
		behållaren[bifogaBarn](tavlan)
		

		vertexSkuggare = mb[skapaSkuggare](mb[VERTEX_SKUGGARE])
		mb[skuggarKälla](vertexSkuggare, `
			precision highp float;

			${egenskap} vec4 e_plats;
			${egenskap} vec4 e_nyans;
			${egenskap} vec3 e_cirkulation;
			${egenskap} vec3 e_hastighet;
			${egenskap} float e_storlek;

			uniform float l_tid;
			uniform vec2 l_noggrannhet;
			uniform mat4 l_projicering;
			uniform vec3 l_jordStorlek;
			uniform float l_newton;
			uniform float l_vinden;

			varying vec4 v_color;
			varying float v_rotation;

			void main() {

				v_color = e_nyans;
				v_rotation = e_cirkulation.x + l_tid * e_cirkulation.y;

				vec3 pos = e_plats.xyz;

				pos.x = mod(pos.x + l_tid + l_vinden * e_hastighet.x, l_jordStorlek.x * 2.0) - l_jordStorlek.x;
				pos.y = mod(pos.y - l_tid * e_hastighet.y * l_newton, l_jordStorlek.y * 2.0) - l_jordStorlek.y;

				pos.x += sin(l_tid * e_hastighet.z) * e_cirkulation.z;
				pos.z += cos(l_tid * e_hastighet.z) * e_cirkulation.z;

				gl_Position = l_projicering * vec4( pos.xyz, e_plats.w );
				gl_PointSize = ( e_storlek / gl_Position.w ) * 100.0;

			}`)
		mb[kompileraSkuggare](vertexSkuggare)
		om(!mb[hämtaSkuggVariabel](vertexSkuggare, mb[KOMPILATIONS_STATUS]), () => {
			notera(mb[hämtaSkuggDeklarationsLoggbok](vertexSkuggare))
			mb[utplånaSkuggare](vertexSkuggare)
			kasta("nåt gick fel vid skapandet av vertexskuggaren")
		})
		notera("vertexSkuggare initierad")

		skärvSkuggare = mb[skapaSkuggare](mb[SKÄRV_SKUGGARE])
		mb[skuggarKälla](skärvSkuggare, `
			precision highp float;

			uniform sampler2D u_texture;

			varying vec4 v_color;
			varying float v_rotation;

			void main() {

				vec2 rotated = vec2(
					cos(v_rotation) * (gl_PointCoord.x - 0.5) + sin(v_rotation) * (gl_PointCoord.y - 0.5) + 0.5,
					cos(v_rotation) * (gl_PointCoord.y - 0.5) - sin(v_rotation) * (gl_PointCoord.x - 0.5) + 0.5
				);

				vec4 snowflake = texture2D(u_texture, rotated);

				gl_FragColor = vec4(snowflake.rgb, snowflake.a * v_color.a);

			}`)
		mb[kompileraSkuggare](skärvSkuggare)
		om(!mb[hämtaSkuggVariabel](skärvSkuggare, mb[KOMPILATIONS_STATUS]), () => {
			notera(mb[hämtaSkuggDeklarationsLoggbok](skärvSkuggare))
			mb[utplånaSkuggare](skärvSkuggare)
			kasta("nåt e fel med skärvskuggaren")
		})
		notera("skärvSkuggare initierad")

		dagordning = mb[skapaDagordning]()

		mb[bifogaSkuggare](dagordning, vertexSkuggare)
		mb[bifogaSkuggare](dagordning, skärvSkuggare)
		mb[länkaDagordning](dagordning)
		
		om(!mb[hämtaDagordningsVariabel](dagordning, mb[LÄNK_STATUS]), () => {
			notera(mb[hämtaDagordningsInformationsLoggbok](dagordning))
			mb[förstörDagordning](dagordning)
			kasta("lyckades ej skapa dagordning")
		})
		mb[användDagordning](dagordning)
		notera("dagordning etablerad")

		kamera = {
			synfält: 60,
			nära: 1,
			långbort: 10000,
			förhållande: 1,
			z: 100,
			perspektiv: true,
		}

		kamera.synfältsRadianer = kamera.synfält * τ / 360
		kamera.f = Matte.tan(τ * 0.25 - 0.5 * kamera.synfältsRadianer)
		kamera.inverteradRäckvidd = 1.0 / ( kamera.nära - kamera.långbort)

		räknare = 0
		buffertar = {}
		buffertInställningar = {
			plats: { längd: 3, innehåll: [] },
			nyans: { längd: 4, innehåll: [] },
			storlek: { längd: 1, innehåll: [] },
			cirkulation: { längd: 3, innehåll: [] },
			hastighet: { längd: 3, innehåll: [] },
		}
		Objekt[poster](buffertInställningar)[förVarje](([namn, inställningar]) => {
			notera("Skapar upp buffert:", namn)
			const position = mb[hämtaEgenskapsPlats](dagordning, "e_"+namn)
			const buffert = mb[skapaBuffert]()
			
			mb[snärjBuffert](mb[MATRIS_BUFFER], buffert)
			mb[tillgängliggörVertexEgenskapsMatris](position)
			mb[vertexEgenskapsPekare](position, inställningar.längd, mb[FLYTTAL], falskt, 0, 0)

			let innehåll = inställningar.innehåll
			Objekt[definieraEgendom](buffertar, namn, {
				[ställ]: värde => {
					innehåll = värde
					mb[snärjBuffert](mb[MATRIS_BUFFER], buffert)
					mb[buffraInnehåll](mb[MATRIS_BUFFER], nyFlyttals32Matris(värde), mb[STATISK_RITNING])
					om(namn == 'plats', () => {
						räknare = innehåll.length / 3
					})
				},
				[hämta]: () => innehåll
			})
		})
		mb[snärjBuffert](mb[MATRIS_BUFFER], null)

		likformiga = {}
		likformigaInställningar = {
			tid: { typ: 'flyttal', innehåll: [0] },
			noggrannhet: { typ: 'bivektor', innehåll: [ 0, 0 ] },
			projicering: { typ: 'quadmatris', innehåll: [ falskt, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1 ]] },
			jordStorlek: { typ: 'trivektor', innehåll: [ 0, 0, 0 ] },
			newton: { typ: 'flyttal', innehåll: [100] },
			vinden :{ typ: 'flyttal', innehåll: [0] },
		}
		vinden = {
			nuvarande: 0,
			kraft: 0.1,
			mål: 0.1,
			lägsta: 0.1,
			högsta: 0.25,
			mjukgörare: 0.005
		}

		Objekt[poster](likformigaInställningar)[förVarje](([namn, inställningar]) => {
			notera("Skapar upp likformighet:", namn)
			const plats = mb[hämtaLikformigPlats](dagordning, "l_"+namn)

			let innehåll = inställningar.innehåll
			Objekt[definieraEgendom](likformiga, namn, {
				[ställ]: värde => {
					innehåll = värde
					mb[likformsTyper[inställningar.typ]](plats, ...värde)
				},
				[hämta]: () => innehåll
			})
			likformiga[namn] = inställningar.innehåll
		})

		notera("skapar upp struktur")
		struktur = mb[skapaStruktur]()
		mb[snärjStruktur](mb[STRUKTUR_2D], struktur)
		mb[strukturBild2D](mb[STRUKTUR_2D], 0, mb.RGBA, 1, 1, 0, mb.RGBA, mb[OSIGNERAD_OKTETT], nyOsigneradHeltalsOktettMatris([0, 0, 0, 0]))

		strukturBild = hämtaRadiatorEfterLegitimation('solen')
		// strukturBild = new Image()


		strukturBild[påLaddning] = () => {
			notera("läser in struktur")
			mb[snärjStruktur](mb[STRUKTUR_2D], struktur)
			notera(mb[STRUKTUR_2D], struktur)
			mb[strukturBild2D](mb[STRUKTUR_2D], 0, mb.RGBA, mb.RGBA, mb[OSIGNERAD_OKTETT], strukturBild)
			notera(mb[STRUKTUR_2D], 0, mb.RGBA, mb.RGBA, mb[OSIGNERAD_OKTETT], strukturBild)
			mb[strukturVariabelHeltal](mb[STRUKTUR_2D], mb[STRUKTUR_MINIFIERINGSSIL], mb[LINJÄR])
			notera(mb[STRUKTUR_2D], mb[STRUKTUR_MINIFIERINGSSIL], mb[LINJÄR])
			mb[strukturVariabelHeltal](mb[STRUKTUR_2D], mb[STRUKTUR_FÖRSTORINGSSIL], mb[LINJÄR])
			notera(mb[STRUKTUR_2D], mb[STRUKTUR_FÖRSTORINGSSIL], mb[LINJÄR])
			mb[strukturVariabelHeltal](mb[STRUKTUR_2D], mb[STRUKTUR_OMSLAG_S], mb[KLÄMTILL_MOT_KANT])
			notera(mb[STRUKTUR_2D], mb[STRUKTUR_OMSLAG_S], mb[KLÄMTILL_MOT_KANT])
			mb[strukturVariabelHeltal](mb[STRUKTUR_2D], mb[STRUKTUR_OMSLAG_T], mb[KLÄMTILL_MOT_KANT])
			notera(mb[STRUKTUR_2D], mb[STRUKTUR_OMSLAG_T], mb[KLÄMTILL_MOT_KANT])
		}
		// strukturBild.src = snöflinga

		mb[möjliggör](mb[SAMMANSMÄLTNING])
		mb[möjliggör](mb[GALLRA_YTA])
		mb[sammansmältningsFunktion](mb[KÄLLA_OGENOMSKINLIGHET], mb[ETT])
		mb[stängAv](mb[DJUP_TEST])

		påOmskalning = () => {

			fullBredd = behållaren.offsetWidth
			fullHöjd = behållaren.offsetHeight
			förhållande = fullBredd / fullHöjd
			dpi = Matte.max(1, devicePixelRatio)

			tavlan[bredd] = fullBredd
			tavlan[höjd] = fullHöjd
			tavlan[stil][bredd] = fullBredd
			tavlan[stil][höjd] = fullHöjd

			mb[fönsterHamn](0, 0, fullBredd * dpi, fullHöjd * dpi)
			mb[rengörNyans](0, 0, 0, 0)


			// z i räckvidden från -80 till 80, kamera avståndet är 100
			// maximal höjd vid z av -80 är 110
			const jordHöjd = 110
			const jordBredd = förhållande * 110
			const djup = 80

			likformiga.noggrannhet = [fullBredd, fullHöjd]
			likformiga.projicering = [falskt, om(kamera.perspektiv, () => [
					kamera.f / förhållande, 0, 0, 0,
					0, kamera.f, 0, 0,
					0, 0, (kamera.nära + kamera.långbort) * kamera.inverteradRäckvidd, -1,
					0, 0, kamera.nära * kamera.långbort * kamera.inverteradRäckvidd * 2 + kamera.z, kamera.z
				], () => [
					2 / fullBredd, 0, 0, 0,
					0, -2 / fullHöjd, 0, 0,
					0, 0, 1, 0,
					-1, 1, 0, 1,
				])]
			likformiga.jordStorlek = [ jordBredd, jordHöjd, djup ]
			
			enhetsVärden = {
				plats: [],
				nyans: [],
				storlek: [],
				cirkulation: [],
				hastighet: [],
			}

			Array.from( { length: förhållande * 500 }, snowflake =>  {

				enhetsVärden.plats.push(
					-jordBredd + slump() * jordBredd * 2,
					-jordHöjd + slump() * jordHöjd * 2,
					slump() * djup * 2
				)

				enhetsVärden.hastighet.push(// 0, 0, 0 )
					1 + slump(),
					1 + slump(),
					slump() * 10
				) // x, y, sinusoid

				enhetsVärden.cirkulation.push(
					slump() * 2 * τ,
					slump() * 20,
					slump() * 10
				) // angle, speed, sinusoid

				enhetsVärden.nyans.push(
					1,
					1,
					1,
					0.1 + slump() * 0.2
				)

				enhetsVärden.storlek.push(
					5 * slump() * 5 * ( fullHöjd * dpi / 1000 )
				)

			} )

			buffertar.plats = enhetsVärden.plats
			buffertar.nyans = enhetsVärden.nyans
			buffertar.cirkulation = enhetsVärden.cirkulation
			buffertar.storlek = enhetsVärden.storlek
			buffertar.hastighet = enhetsVärden.hastighet
		}
		fönster[läggTillHändelseSpanare](omskalning, påOmskalning, falskt)
		påOmskalning()

		tiden = { början: prestanda[nu](), gamla: prestanda[nu]() }
		uppdatera = () => {
			// notera("uppdaterar")
			aktuellt = prestanda[nu]()
			förflutit = (aktuellt - tiden.början) / 5000
			delta = aktuellt - tiden.gamla
			tiden.gamla = aktuellt
			
			likformiga.tid = [förflutit]

			om(räknare > 0, () => {
				// notera("hej?")
				// mb[rensa](mb[NYANSBUFFERBIT])
				mb[ritaMatriser](mb[PUNKTER], 0, räknare)
			})


			vinden.kraft += ( vinden.mål - vinden.kraft ) * vinden.easing
			vinden.nuvarande += vinden.kraft * ( delta * 0.2 )
			likformiga.vind = [vinden.nuvarande]

			om( slump() > 0.995, () => {
				vinden.mål = ( vinden.min + slump() * ( vinden.max - vinden.min ) ) * ( slump() > 0.5 ? -1 : 1 )
			})
			begärAnimationsRuta(uppdatera)
		}
		uppdatera()
	})
	
</script>

</html>